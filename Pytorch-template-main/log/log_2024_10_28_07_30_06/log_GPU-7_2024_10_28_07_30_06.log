2024-10-28 07:30:14.375 | GPU-7 | INFO    | utils.config:ddp_variables:73 - LOCAL_RANK:1
2024-10-28 07:30:14.376 | GPU-7 | INFO    | utils.config:ddp_variables:73 - RANK:1
2024-10-28 07:30:14.376 | GPU-7 | INFO    | utils.config:ddp_variables:73 - GROUP_RANK:0
2024-10-28 07:30:14.376 | GPU-7 | INFO    | utils.config:ddp_variables:73 - ROLE_RANK:1
2024-10-28 07:30:14.376 | GPU-7 | INFO    | utils.config:ddp_variables:73 - LOCAL_WORLD_SIZE:2
2024-10-28 07:30:14.376 | GPU-7 | INFO    | utils.config:ddp_variables:73 - WORLD_SIZE:2
2024-10-28 07:30:14.376 | GPU-7 | INFO    | utils.config:ddp_variables:73 - ROLE_WORLD_SIZE:2
2024-10-28 07:30:14.376 | GPU-7 | INFO    | utils.config:ddp_variables:73 - MASTER_ADDR:127.0.0.1
2024-10-28 07:30:14.376 | GPU-7 | INFO    | utils.config:ddp_variables:73 - MASTER_PORT:24568
2024-10-28 07:30:14.381 | GPU-7 | INFO    | __main__:<module>:19 - Passed args {'mode': 'train', 'batch_size': {'train': 16, 'eval': 128}, 'data_path': {'data_dir': '/mnt/data3/zz/cicc/', 'train': 'data/train_data_Yi-1___5-34B-Chat-16K_analysis.json', 'eval': 'data/val_data_Yi-1___5-34B-Chat-16K_analysis.json', 'test': 'data/test_data_Yi-1___5-34B-Chat-16K_analysis.json', 'predict': ''}, 'model_path': {'pretrained_model_dir': '/mnt/data1/model/', 'pretrained_model': 'ernie-3___0-xbase-zh', 'tokenizer': 'ernie-3___0-xbase-zh', 'save': True, 'snapshot_dir': 'save_models', 'snapshot': 'best_snapshot.pt'}, 'criterion': 'CrossEntropyLoss', 'optimizer': 'AdamW', 'scheduler': {'name': 'linear', 'ratio': 0.1}, 'metrics': 'ClassificationReport', 'main_metric': 'macro_avg_f1-score', 'max_epochs': 10, 'seed': 42, 'early_stop': 10, 'lr': 5e-06, 'dropout': 0.9, 'CICC': {'max_length': 1024, 'num_classes': 7}, 'logger': <loguru.logger handlers=[(id=1, level=5, sink=<lambda>), (id=2, level=10, sink='log/log_2024_10_28_07_30_06/log_GPU-7_2024_10_28_07_30_06.log')]>, 'device': 'GPU-7', 'global_device': 'GPU-6', 'world_size': 2, 'datetime': '2024_10_28_07_30_06'}
2024-10-28 07:30:14.382 | GPU-7 | INFO    | utils.get_bert_and_tokenizer:getTokenizer:29 - load /mnt/data1/model/ernie-3___0-xbase-zh tokenizer
2024-10-28 07:30:14.436 | GPU-7 | INFO    | dataset.CICCDataset:__init__:24 - Creating features from dataset file at /mnt/data3/zz/cicc/data/train_data_Yi-1___5-34B-Chat-16K_analysis.json
2024-10-28 07:30:35.704 | GPU-7 | INFO    | utils.get_bert_and_tokenizer:getTokenizer:29 - load /mnt/data1/model/ernie-3___0-xbase-zh tokenizer
2024-10-28 07:30:35.764 | GPU-7 | INFO    | dataset.CICCDataset:__init__:24 - Creating features from dataset file at /mnt/data3/zz/cicc/data/val_data_Yi-1___5-34B-Chat-16K_analysis.json
2024-10-28 07:30:36.416 | GPU-7 | INFO    | utils.get_bert_and_tokenizer:getTokenizer:29 - load /mnt/data1/model/ernie-3___0-xbase-zh tokenizer
2024-10-28 07:30:36.478 | GPU-7 | INFO    | dataset.CICCDataset:__init__:24 - Creating features from dataset file at /mnt/data3/zz/cicc/data/test_data_Yi-1___5-34B-Chat-16K_analysis.json
2024-10-28 07:30:36.486 | GPU-7 | WARNING | dataset.CICCDataset:__init__:41 - Missing Data Label
2024-10-28 07:30:37.143 | GPU-7 | INFO    | __main__:<module>:45 - ({'input_ids': tensor([226, 957, 614,  ...,   0,   0,   0]), 'token_type_ids': tensor([0, 0, 0,  ..., 0, 0, 0]), 'attention_mask': tensor([1, 1, 1,  ..., 0, 0, 0]), 'labels': tensor(1)}, {'text': '你笑什么？我在问你话呢 情感标签：【生气】\n\n分析理由：陈江河的这句话中，“你笑什么？”表达了一种质问和不满的情绪，可能是因为骆玉珠在不应该笑的时候笑了，或者陈江河认为骆玉珠的笑是对他的不尊重或者不认真对待他的问题。紧接着的“我在问你话呢”更加强化了这种不满的情绪，显示出陈江河对骆玉珠的行为感到生气，并且希望得到她的注意和认真回答。', 'label_str': 'Anger'})
2024-10-28 07:30:37.152 | GPU-7 | INFO    | __main__:<module>:46 - ({'input_ids': tensor([ 75,   5, 240,  ...,   0,   0,   0]), 'token_type_ids': tensor([0, 0, 0,  ..., 0, 0, 0]), 'attention_mask': tensor([1, 1, 1,  ..., 0, 0, 0]), 'labels': tensor(5)}, {'text': '我的两百美金没了 陆远的话语“我的两百美金没了”表达了一种损失或失窃的情感。这种情况下，陆远可能感到沮丧、失望或焦虑，因为他失去了金钱。因此，情感标签应为【伤心】或【生气】，具体取决于陆远失去金钱时的情绪反应。如果他感到更多的是失望和沮丧，那么【伤心】可能更合适；如果他感到愤怒和不满，那么【生气】可能更合适。由于没有更多的上下文信息，我们无法确定陆远的确切情感，但基于话语本身，【伤心】或【生气】是可能的情感标签。', 'label_str': 'Sad'})
2024-10-28 07:30:37.153 | GPU-7 | INFO    | utils.get_bert_and_tokenizer:getBert:21 - load /mnt/data1/model/ernie-3___0-xbase-zh
2024-10-28 07:30:37.324 | GPU-7 | WARNING | trainer:_load_snapshot:575 - save_models/2024_10_28_07_30_06 not exist, Initialize from Scratch
2024-10-28 07:30:38.086 | GPU-7 | INFO    | trainer:_get_optimizer_and_scheduler:142 - Total train steps: 16870
2024-10-28 08:28:07.715 | GPU-7 | INFO    | trainer:train:290 - Train Epoch: 1 Loss: 1.9534547313412218
2024-10-28 08:46:23.753 | GPU-7 | INFO    | trainer:train:296 - Train Eval Epoch: 1 Metrics: {'Not Main Process': 0.0}
2024-10-28 08:47:14.120 | GPU-7 | INFO    | trainer:train:313 - Eval Epoch: 1 Metrics: {'Not Main Process': 0.0}
2024-10-28 09:44:47.923 | GPU-7 | INFO    | trainer:train:290 - Train Epoch: 2 Loss: 1.8584795968509964
2024-10-28 10:03:03.413 | GPU-7 | INFO    | trainer:train:296 - Train Eval Epoch: 2 Metrics: {'Not Main Process': 0.0}
2024-10-28 10:03:53.734 | GPU-7 | INFO    | trainer:train:313 - Eval Epoch: 2 Metrics: {'Not Main Process': 0.0}
2024-10-28 11:01:28.266 | GPU-7 | INFO    | trainer:train:290 - Train Epoch: 3 Loss: 1.7032820056258784
2024-10-28 11:19:43.956 | GPU-7 | INFO    | trainer:train:296 - Train Eval Epoch: 3 Metrics: {'Not Main Process': 0.0}
2024-10-28 11:20:34.297 | GPU-7 | INFO    | trainer:train:313 - Eval Epoch: 3 Metrics: {'Not Main Process': 0.0}
2024-10-28 12:18:10.521 | GPU-7 | INFO    | trainer:train:290 - Train Epoch: 4 Loss: 1.6039918411823246
2024-10-28 12:36:25.902 | GPU-7 | INFO    | trainer:train:296 - Train Eval Epoch: 4 Metrics: {'Not Main Process': 0.0}
2024-10-28 12:37:16.263 | GPU-7 | INFO    | trainer:train:313 - Eval Epoch: 4 Metrics: {'Not Main Process': 0.0}
2024-10-28 13:34:52.582 | GPU-7 | INFO    | trainer:train:290 - Train Epoch: 5 Loss: 1.53093036564323
2024-10-28 13:53:08.397 | GPU-7 | INFO    | trainer:train:296 - Train Eval Epoch: 5 Metrics: {'Not Main Process': 0.0}
2024-10-28 13:53:58.738 | GPU-7 | INFO    | trainer:train:313 - Eval Epoch: 5 Metrics: {'Not Main Process': 0.0}
2024-10-28 14:51:29.173 | GPU-7 | INFO    | trainer:train:290 - Train Epoch: 6 Loss: 1.4747529467700218
2024-10-28 15:09:44.718 | GPU-7 | INFO    | trainer:train:296 - Train Eval Epoch: 6 Metrics: {'Not Main Process': 0.0}
2024-10-28 15:10:35.046 | GPU-7 | INFO    | trainer:train:313 - Eval Epoch: 6 Metrics: {'Not Main Process': 0.0}
2024-10-28 16:08:06.813 | GPU-7 | INFO    | trainer:train:290 - Train Epoch: 7 Loss: 1.4330951274853747
2024-10-28 16:26:22.369 | GPU-7 | INFO    | trainer:train:296 - Train Eval Epoch: 7 Metrics: {'Not Main Process': 0.0}
2024-10-28 16:27:12.711 | GPU-7 | INFO    | trainer:train:313 - Eval Epoch: 7 Metrics: {'Not Main Process': 0.0}
2024-10-28 17:24:48.929 | GPU-7 | INFO    | trainer:train:290 - Train Epoch: 8 Loss: 1.3987213662732834
2024-10-28 17:43:04.527 | GPU-7 | INFO    | trainer:train:296 - Train Eval Epoch: 8 Metrics: {'Not Main Process': 0.0}
2024-10-28 17:43:54.877 | GPU-7 | INFO    | trainer:train:313 - Eval Epoch: 8 Metrics: {'Not Main Process': 0.0}
2024-10-28 18:41:25.728 | GPU-7 | INFO    | trainer:train:290 - Train Epoch: 9 Loss: 1.3748278452604303
2024-10-28 18:59:41.370 | GPU-7 | INFO    | trainer:train:296 - Train Eval Epoch: 9 Metrics: {'Not Main Process': 0.0}
2024-10-28 19:00:31.703 | GPU-7 | INFO    | trainer:train:313 - Eval Epoch: 9 Metrics: {'Not Main Process': 0.0}
2024-10-28 19:58:03.491 | GPU-7 | INFO    | trainer:train:290 - Train Epoch: 10 Loss: 1.357935955809756
2024-10-28 20:16:19.046 | GPU-7 | INFO    | trainer:train:296 - Train Eval Epoch: 10 Metrics: {'Not Main Process': 0.0}
2024-10-28 20:17:09.385 | GPU-7 | INFO    | trainer:train:313 - Eval Epoch: 10 Metrics: {'Not Main Process': 0.0}
2024-10-28 20:17:09.400 | GPU-7 | INFO    | trainer:train:348 - Best Metric: {'train': {'metric': 0, 'epoch': 0}, 'eval': {'metric': 0, 'epoch': 0}, 'test': {'metric': 0, 'epoch': 0}}
2024-10-28 20:17:09.923 | GPU-7 | INFO    | __main__:<module>:81 - Program Exited Normally
