2024-10-29 15:19:39.265 | GPU-0 | INFO    | utils.config:ddp_variables:73 - LOCAL_RANK:0
2024-10-29 15:19:39.268 | GPU-0 | INFO    | utils.config:ddp_variables:73 - RANK:0
2024-10-29 15:19:39.269 | GPU-0 | INFO    | utils.config:ddp_variables:73 - GROUP_RANK:0
2024-10-29 15:19:39.270 | GPU-0 | INFO    | utils.config:ddp_variables:73 - ROLE_RANK:0
2024-10-29 15:19:39.271 | GPU-0 | INFO    | utils.config:ddp_variables:73 - LOCAL_WORLD_SIZE:1
2024-10-29 15:19:39.272 | GPU-0 | INFO    | utils.config:ddp_variables:73 - WORLD_SIZE:1
2024-10-29 15:19:39.272 | GPU-0 | INFO    | utils.config:ddp_variables:73 - ROLE_WORLD_SIZE:1
2024-10-29 15:19:39.273 | GPU-0 | INFO    | utils.config:ddp_variables:73 - MASTER_ADDR:127.0.0.1
2024-10-29 15:19:39.274 | GPU-0 | INFO    | utils.config:ddp_variables:73 - MASTER_PORT:34285
2024-10-29 15:19:39.277 | GPU-0 | INFO    | __main__:<module>:19 - Passed args {'mode': 'test', 'batch_size': {'train': 16, 'eval': 1, 'predict': 1}, 'data_path': {'data_dir': '/mnt/data3/zz/cicc/', 'train': 'data/train_data_Qwen2___5-72B-Instruct_analysis.json', 'eval': 'data/val_data_Qwen2___5-72B-Instruct_analysis.json', 'test': 'data/test_data_Qwen2___5-72B-Instruct_analysis.json'}, 'model_path': {'pretrained_model_dir': '/mnt/data1/model/', 'pretrained_model': 'ernie-3___0-xbase-zh', 'tokenizer': 'ernie-3___0-xbase-zh', 'save': True, 'snapshot_dir': 'save_models', 'snapshot': 'best_snapshot.pt'}, 'criterion': 'CrossEntropyLoss', 'optimizer': 'AdamW', 'scheduler': {'name': 'linear', 'ratio': 0.1}, 'metrics': 'ClassificationReport', 'main_metric': 'macro_avg_f1-score', 'max_epochs': 10, 'seed': 42, 'early_stop': 10, 'lr': 5e-06, 'dropout': 0.6, 'CICC': {'max_length': 1024, 'num_classes': 7}, 'logger': <loguru.logger handlers=[(id=1, level=5, sink=<lambda>), (id=2, level=10, sink='log/log_2024_10_28_08_20_46/log_GPU-0_2024_10_28_08_20_46.log')]>, 'device': 'GPU-0', 'global_device': 'GPU-0', 'world_size': 1, 'datetime': '2024_10_28_08_20_46'}
2024-10-29 15:19:39.280 | GPU-0 | INFO    | utils.get_bert_and_tokenizer:getTokenizer:29 - load /mnt/data1/model/ernie-3___0-xbase-zh tokenizer
2024-10-29 15:19:39.331 | GPU-0 | INFO    | dataset.CICCDataset:__init__:24 - Creating features from dataset file at /mnt/data3/zz/cicc/data/train_data_Qwen2___5-72B-Instruct_analysis.json
2024-10-29 15:19:47.004 | GPU-0 | INFO    | utils.get_bert_and_tokenizer:getTokenizer:29 - load /mnt/data1/model/ernie-3___0-xbase-zh tokenizer
2024-10-29 15:19:47.259 | GPU-0 | INFO    | dataset.CICCDataset:__init__:24 - Creating features from dataset file at /mnt/data3/zz/cicc/data/val_data_Qwen2___5-72B-Instruct_analysis.json
2024-10-29 15:19:48.001 | GPU-0 | INFO    | utils.get_bert_and_tokenizer:getTokenizer:29 - load /mnt/data1/model/ernie-3___0-xbase-zh tokenizer
2024-10-29 15:19:48.068 | GPU-0 | INFO    | dataset.CICCDataset:__init__:24 - Creating features from dataset file at /mnt/data3/zz/cicc/data/test_data_Qwen2___5-72B-Instruct_analysis.json
2024-10-29 15:19:48.082 | GPU-0 | WARNING | dataset.CICCDataset:__init__:41 - Missing Data Label
2024-10-29 15:19:48.779 | GPU-0 | INFO    | __main__:<module>:45 - ({'input_ids': tensor([226, 957, 614,  ...,   0,   0,   0]), 'token_type_ids': tensor([0, 0, 0,  ..., 0, 0, 0]), 'attention_mask': tensor([1, 1, 1,  ..., 0, 0, 0]), 'labels': tensor(1)}, {'text': '你笑什么？我在问你话呢 骆玉珠在这段对话中的反应没有具体描述，但从陈江河的话语来看，他可能感觉到被忽视或不被重视了，但并没有表现出强烈的情绪波动。因此，陈江河的情感标签应为【正常】。如果需要更准确地判断骆玉珠的情感状态，我们需要更多关于她当时行为或表情的信息。基于现有信息，我们只能对陈江河的情感做出判断。', 'label_str': 'Anger'})
2024-10-29 15:19:48.791 | GPU-0 | INFO    | __main__:<module>:46 - ({'input_ids': tensor([ 75,   5, 240,  ...,   0,   0,   0]), 'token_type_ids': tensor([0, 0, 0,  ..., 0, 0, 0]), 'attention_mask': tensor([1, 1, 1,  ..., 0, 0, 0]), 'labels': tensor(5)}, {'text': '我的两百美金没了 甘敬尚未回应，但从陆远的话语中可以看出他对钱丢失感到不悦，但没有明显的情绪激动或愤怒，因此情感标签应为【正常】。如果他表现出更强烈的情绪反应，比如愤怒或悲伤，那么标签可能会有所不同。目前，我们只能根据现有信息判断。', 'label_str': 'Sad'})
2024-10-29 15:19:48.793 | GPU-0 | INFO    | utils.get_bert_and_tokenizer:getBert:21 - load /mnt/data1/model/ernie-3___0-xbase-zh
2024-10-29 15:19:51.075 | GPU-0 | INFO    | trainer:_load_snapshot:590 - Resuming from snapshot at Epoch 4
2024-10-29 15:19:52.651 | GPU-0 | ERROR   | trainer:__init__:100 - No Test Dataset Passed
2024-10-29 15:22:00.797 | GPU-0 | INFO    | trainer:eval:388 - Eval Metrics: {'0_precision': 0.6689655172413793, '0_recall': 0.3233333333333333, '0_f1-score': 0.43595505617977526, '0_support': 1200.0, '1_precision': 0.35259259259259257, '1_recall': 0.6149870801033591, '1_f1-score': 0.448210922787194, '1_support': 387.0, '2_precision': 0.2911764705882353, '2_recall': 0.4177215189873418, '2_f1-score': 0.3431542461005199, '2_support': 237.0, '3_precision': 0.4157303370786517, '3_recall': 0.5522388059701493, '3_f1-score': 0.47435897435897434, '3_support': 67.0, '4_precision': 0.28654970760233917, '4_recall': 0.33793103448275863, '4_f1-score': 0.310126582278481, '4_support': 145.0, '5_precision': 0.3127147766323024, '5_recall': 0.44717444717444715, '5_f1-score': 0.36804853387259856, '5_support': 407.0, '6_precision': 0.17777777777777778, '6_recall': 0.20512820512820512, '6_f1-score': 0.19047619047619047, '6_support': 39.0, 'accuracy': 0.403303787268332, 'macro_avg_precision': 0.35792959707332545, 'macro_avg_recall': 0.41407348931137067, 'macro_avg_f1-score': 0.36719007229339046, 'macro_avg_support': 2482.0, 'weighted_avg_precision': 0.48824845494024555, 'weighted_avg_recall': 0.40330378726833194, 'weighted_avg_f1-score': 0.4076978167958693, 'weighted_avg_support': 2482.0}
2024-10-29 15:26:15.202 | GPU-0 | INFO    | trainer:predict:436 - Predict Finished
2024-10-29 15:26:15.725 | GPU-0 | INFO    | __main__:<module>:81 - Program Exited Normally
