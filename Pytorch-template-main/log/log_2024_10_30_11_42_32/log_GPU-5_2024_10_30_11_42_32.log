2024-10-30 11:42:36.333 | GPU-5 | INFO    | utils.config:ddp_variables:73 - LOCAL_RANK:1
2024-10-30 11:42:36.334 | GPU-5 | INFO    | utils.config:ddp_variables:73 - RANK:1
2024-10-30 11:42:36.334 | GPU-5 | INFO    | utils.config:ddp_variables:73 - GROUP_RANK:0
2024-10-30 11:42:36.334 | GPU-5 | INFO    | utils.config:ddp_variables:73 - ROLE_RANK:1
2024-10-30 11:42:36.334 | GPU-5 | INFO    | utils.config:ddp_variables:73 - LOCAL_WORLD_SIZE:2
2024-10-30 11:42:36.334 | GPU-5 | INFO    | utils.config:ddp_variables:73 - WORLD_SIZE:2
2024-10-30 11:42:36.334 | GPU-5 | INFO    | utils.config:ddp_variables:73 - ROLE_WORLD_SIZE:2
2024-10-30 11:42:36.335 | GPU-5 | INFO    | utils.config:ddp_variables:73 - MASTER_ADDR:127.0.0.1
2024-10-30 11:42:36.335 | GPU-5 | INFO    | utils.config:ddp_variables:73 - MASTER_PORT:27815
2024-10-30 11:42:36.338 | GPU-5 | INFO    | __main__:<module>:19 - Passed args {'mode': 'train', 'batch_size': {'train': 16, 'eval': 128}, 'data_path': {'data_dir': '/mnt/data3/zz/cicc/', 'train': 'data/train_data_Qwen2-72B-Instruct_analysis.json', 'eval': 'data/val_data_Qwen2-72B-Instruct_analysis.json', 'test': 'data/test_data_Qwen2-72B-Instruct_analysis.json', 'predict': ''}, 'model_path': {'pretrained_model_dir': '/mnt/data1/model/', 'pretrained_model': 'ernie-3___0-xbase-zh', 'tokenizer': 'ernie-3___0-xbase-zh', 'save': True, 'snapshot_dir': 'save_models', 'snapshot': 'best_snapshot.pt'}, 'criterion': 'CrossEntropyLoss', 'optimizer': 'AdamW', 'scheduler': {'name': 'linear', 'ratio': 0.1}, 'metrics': 'ClassificationReport', 'main_metric': 'macro_avg_f1-score', 'max_epochs': 10, 'seed': 42, 'early_stop': 10, 'lr': 5e-06, 'dropout': 0.2, 'CICC': {'max_length': 1024, 'num_classes': 7}, 'logger': <loguru.logger handlers=[(id=1, level=5, sink=<lambda>), (id=2, level=10, sink='log/log_2024_10_30_11_42_32/log_GPU-5_2024_10_30_11_42_32.log')]>, 'device': 'GPU-5', 'global_device': 'GPU-4', 'world_size': 2, 'datetime': '2024_10_30_11_42_32'}
2024-10-30 11:42:36.338 | GPU-5 | INFO    | utils.get_bert_and_tokenizer:getTokenizer:29 - load /mnt/data1/model/ernie-3___0-xbase-zh tokenizer
2024-10-30 11:42:36.388 | GPU-5 | INFO    | dataset.CICCDataset:__init__:24 - Creating features from dataset file at /mnt/data3/zz/cicc/data/train_data_Qwen2-72B-Instruct_analysis.json
2024-10-30 11:42:58.091 | GPU-5 | INFO    | utils.get_bert_and_tokenizer:getTokenizer:29 - load /mnt/data1/model/ernie-3___0-xbase-zh tokenizer
2024-10-30 11:42:58.165 | GPU-5 | INFO    | dataset.CICCDataset:__init__:24 - Creating features from dataset file at /mnt/data3/zz/cicc/data/val_data_Qwen2-72B-Instruct_analysis.json
2024-10-30 11:42:58.920 | GPU-5 | INFO    | utils.get_bert_and_tokenizer:getTokenizer:29 - load /mnt/data1/model/ernie-3___0-xbase-zh tokenizer
2024-10-30 11:42:59.001 | GPU-5 | INFO    | dataset.CICCDataset:__init__:24 - Creating features from dataset file at /mnt/data3/zz/cicc/data/test_data_Qwen2-72B-Instruct_analysis.json
2024-10-30 11:42:59.013 | GPU-5 | WARNING | dataset.CICCDataset:__init__:41 - Missing Data Label
2024-10-30 11:42:59.793 | GPU-5 | INFO    | __main__:<module>:45 - ({'input_ids': tensor([226, 957, 614,  ...,   0,   0,   0]), 'token_type_ids': tensor([0, 0, 0,  ..., 0, 0, 0]), 'attention_mask': tensor([1, 1, 1,  ..., 0, 0, 0]), 'labels': tensor(1)}, {'text': '你笑什么？我在问你话呢 陈江河在这句话中表现出了一种轻微的生气情绪，因为他正在询问骆玉珠为什么笑，同时强调自己在问她问题，似乎对于她的笑声有些不满或者感到被忽视了。因此情感标签应为【生气】。', 'label_str': 'Anger'})
2024-10-30 11:42:59.802 | GPU-5 | INFO    | __main__:<module>:46 - ({'input_ids': tensor([ 75,   5, 240,  ...,   0,   0,   0]), 'token_type_ids': tensor([0, 0, 0,  ..., 0, 0, 0]), 'attention_mask': tensor([1, 1, 1,  ..., 0, 0, 0]), 'labels': tensor(5)}, {'text': '我的两百美金没了 陆远在说他的两百美金没了，这通常会让人感到不悦或沮丧，因为丢失财物是一种负面的经历。因此，情感标签应为【伤心】。', 'label_str': 'Sad'})
2024-10-30 11:42:59.803 | GPU-5 | INFO    | utils.get_bert_and_tokenizer:getBert:21 - load /mnt/data1/model/ernie-3___0-xbase-zh
2024-10-30 11:43:00.042 | GPU-5 | WARNING | trainer:_load_snapshot:575 - save_models/2024_10_30_11_42_32 not exist, Initialize from Scratch
2024-10-30 11:43:02.260 | GPU-5 | INFO    | trainer:_get_optimizer_and_scheduler:142 - Total train steps: 16870
2024-10-30 12:40:36.108 | GPU-5 | INFO    | trainer:train:290 - Train Epoch: 1 Loss: 1.7184568550349413
2024-10-30 12:58:53.435 | GPU-5 | INFO    | trainer:train:296 - Train Eval Epoch: 1 Metrics: {'Not Main Process': 0.0}
2024-10-30 12:59:43.864 | GPU-5 | INFO    | trainer:train:313 - Eval Epoch: 1 Metrics: {'Not Main Process': 0.0}
2024-10-30 13:57:21.026 | GPU-5 | INFO    | trainer:train:290 - Train Epoch: 2 Loss: 1.0112851344366773
2024-10-30 14:15:38.275 | GPU-5 | INFO    | trainer:train:296 - Train Eval Epoch: 2 Metrics: {'Not Main Process': 0.0}
2024-10-30 14:16:28.689 | GPU-5 | INFO    | trainer:train:313 - Eval Epoch: 2 Metrics: {'Not Main Process': 0.0}
2024-10-30 15:14:06.864 | GPU-5 | INFO    | trainer:train:290 - Train Epoch: 3 Loss: 0.6781838110325884
2024-10-30 15:32:24.287 | GPU-5 | INFO    | trainer:train:296 - Train Eval Epoch: 3 Metrics: {'Not Main Process': 0.0}
2024-10-30 15:33:14.710 | GPU-5 | INFO    | trainer:train:313 - Eval Epoch: 3 Metrics: {'Not Main Process': 0.0}
2024-10-30 16:30:53.091 | GPU-5 | INFO    | trainer:train:290 - Train Epoch: 4 Loss: 0.4705155284995858
2024-10-30 16:49:10.325 | GPU-5 | INFO    | trainer:train:296 - Train Eval Epoch: 4 Metrics: {'Not Main Process': 0.0}
2024-10-30 16:50:00.762 | GPU-5 | INFO    | trainer:train:313 - Eval Epoch: 4 Metrics: {'Not Main Process': 0.0}
2024-10-30 17:47:39.328 | GPU-5 | INFO    | trainer:train:290 - Train Epoch: 5 Loss: 0.3414089807322452
2024-10-30 18:05:57.600 | GPU-5 | INFO    | trainer:train:296 - Train Eval Epoch: 5 Metrics: {'Not Main Process': 0.0}
2024-10-30 18:06:48.082 | GPU-5 | INFO    | trainer:train:313 - Eval Epoch: 5 Metrics: {'Not Main Process': 0.0}
2024-10-30 19:04:31.333 | GPU-5 | INFO    | trainer:train:290 - Train Epoch: 6 Loss: 0.25978664580403754
2024-10-30 19:22:48.912 | GPU-5 | INFO    | trainer:train:296 - Train Eval Epoch: 6 Metrics: {'Not Main Process': 0.0}
2024-10-30 19:23:39.338 | GPU-5 | INFO    | trainer:train:313 - Eval Epoch: 6 Metrics: {'Not Main Process': 0.0}
2024-10-30 20:21:17.925 | GPU-5 | INFO    | trainer:train:290 - Train Epoch: 7 Loss: 0.19430423598025895
2024-10-30 20:39:37.660 | GPU-5 | INFO    | trainer:train:296 - Train Eval Epoch: 7 Metrics: {'Not Main Process': 0.0}
2024-10-30 20:40:28.181 | GPU-5 | INFO    | trainer:train:313 - Eval Epoch: 7 Metrics: {'Not Main Process': 0.0}
2024-10-30 21:38:07.012 | GPU-5 | INFO    | trainer:train:290 - Train Epoch: 8 Loss: 0.1546213343580611
2024-10-30 21:56:27.061 | GPU-5 | INFO    | trainer:train:296 - Train Eval Epoch: 8 Metrics: {'Not Main Process': 0.0}
2024-10-30 21:57:17.589 | GPU-5 | INFO    | trainer:train:313 - Eval Epoch: 8 Metrics: {'Not Main Process': 0.0}
2024-10-30 22:54:55.963 | GPU-5 | INFO    | trainer:train:290 - Train Epoch: 9 Loss: 0.1200788932718928
2024-10-30 23:13:13.559 | GPU-5 | INFO    | trainer:train:296 - Train Eval Epoch: 9 Metrics: {'Not Main Process': 0.0}
2024-10-30 23:14:03.993 | GPU-5 | INFO    | trainer:train:313 - Eval Epoch: 9 Metrics: {'Not Main Process': 0.0}
2024-10-31 00:11:37.685 | GPU-5 | INFO    | trainer:train:290 - Train Epoch: 10 Loss: 0.10188093944121664
2024-10-31 00:29:55.524 | GPU-5 | INFO    | trainer:train:296 - Train Eval Epoch: 10 Metrics: {'Not Main Process': 0.0}
2024-10-31 00:30:45.958 | GPU-5 | INFO    | trainer:train:313 - Eval Epoch: 10 Metrics: {'Not Main Process': 0.0}
2024-10-31 00:30:45.972 | GPU-5 | INFO    | trainer:train:348 - Best Metric: {'train': {'metric': 0, 'epoch': 0}, 'eval': {'metric': 0, 'epoch': 0}, 'test': {'metric': 0, 'epoch': 0}}
2024-10-31 00:30:47.342 | GPU-5 | INFO    | __main__:<module>:81 - Program Exited Normally
